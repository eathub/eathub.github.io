<!DOCTYPE html>
<html lang="es">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="statics/image/favicon.ico">

        <title>EatHub</title>

        <link href="statics/css/bootstrap.min.css" rel="stylesheet">
        <link href="statics/css/starter-template.css" rel="stylesheet">
        <link href="statics/css/font-awesome.min.css" rel="stylesheet">
        <link href="statics/css/lightbox.css" rel="stylesheet"/>
        <link href="statics/css/style-search.css" rel="stylesheet"/>
        <link href='http://fonts.googleapis.com/css?family=Raleway:200' rel='stylesheet' type='text/css'>
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
        <link href="statics/css/bootstrap-select.min.css" rel="stylesheet">
        <link href="statics/css/slider.css" rel="stylesheet">

    </head>
    <body>
            <div id="container">
                <header>
                    <nav class="navbar navbar-default navbar-fixed-top navbar-red" role="navigation">
                        <div class="container">
                            <!-- Brand and toggle get grouped for better mobile display -->
                            <div class="navbar-header">
                                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                                    <span class="sr-only"></span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                </button>
                                <a class="navbar-brand" href="index.html">
                                    <img class="navbar-logo" src="/statics/image/logo_white.png"/>
                                </a>
                            </div>
                            <!-- Collect the nav links, forms, and other content for toggling -->
                            <div class="collapse navbar-collapse">
                                <ul class="nav navbar-nav">
                                    <li class="active"><a href="index.html">Inicio</a></li>
                                    <li><a class="" href="receipes.html">Recetas</a></li>
                                    <li><div class="input-group navbar-input-group fbSearch">
                                    <form id="search-form" class="navbar-form navbar-left" role="search" method="get" action="">
                                        <div class="form-group">
                                            <input type="text" class="form-control border-search border-rect-red" placeholder="Buscar..." name="srchterm" id="srchterm">
                                            <span class="input-group-btn-red navbar-input-group-btn">
                                                <button class="btn btn-default" type="submit">
                                                    <i class="glyphicon glyphicon-search"></i>
                                                </button>
                                            </span>
                                        </div>
                                    <div class="suggest">
                                        <ul>
                                        <li class="header"><span class="text"></span></li>
                                            <li>
                                                <a href="">
                                                    <span class="glyphicon glyphicon-search"></span>
                                                    <span class="text"></span>
                                                    <span class="category"></span>
                                                </a>
                                            </li>
                                            <li class="header"><span class="text"></span></li>
                                            <li>
                                                <a href="">
                                                    <span class="glyphicon glyphicon-search"></span>
                                                    <span class="text"></span>
                                                    <span class="category"></span>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                    </form>
                                </div>
                                <!-- Button trigger modal -->
                                </li>
                                </ul>
                                <ul class="nav navbar-nav navbar-right">
                                    <li>
                                        <div>
                                            <a type="button" class="plus-bar btn btn-default" href="create_recipe.html">
                                                <span class="glyphicon glyphicon-plus"></span> Añadir receta
                                            </a>
                                        </div>
                                    </li>
                                    <a class="btn btn-default btn-eathub-red" href="/login.html" role="button">Acceder</a>
                                </ul>
                            </div>
                        </div>
                    </nav>
                    <!--/.nav-collapse -->
                </header>
                <main>
                    <div class="container">

                        <script src="statics/js/bootstrap-slider.js"></script>
                        <script src="statics/js/bootstrap-select.min.js"></script>
                        <script src="statics/js/repeatable-fields.js"></script>
                        <script src="statics/js/jquery-ui-1.10.4.custom.min.js"></script>
                        <script src="statics/js/ajax-image-upload.js"></script>
                        <script type="text/javascript">
                            var settings;
                            $().ready(function () {
                                $('select').selectpicker();
                                $('.slider').slider();
                                jQuery(function () {
                                    jQuery('.repeat').each(function () {
                                        settings = jQuery(this).repeatable_fields({
                                            wrapper: '.repeatable-wrapper',
                                            container: '.repeatable-container',
                                            row: '.repeatable-row',
                                            add: '.repeatable-add',
                                            remove: '.repeatable-remove',
                                            move: '.repeatable-move',
                                            template: '.repeatable-template',
                                            is_sortable: true,
                                            before_add: null,
                                            before_remove: null,
                                            after_remove: function (container) {
                                                if(container.hasClass("step-container")){
                                                    var num = 1;
                                                    $(".step-num").each(function(index, element) {
                                                        if (index!=0) {
                                                            $(element).html(num++);
                                                        }
                                                    });
                                                }
                                            },
                                            after_add: function (container, new_row) {
                                                if(new_row.hasClass("ingredient-item")){
                                                    new_row.find(".ingredient-input").focus();
                                                }else if(new_row.hasClass("step-item")){
                                                    new_row.find(".step-input").focus();
                                                }

                                            }
                                        });
                                    });
                                });
                            });
                        </script>
                        <script>
                            var galleryArray = {};
                            var associationStepPicture = {};

                            function setMainPicture(url) {
                                $("#main-picture").css('background-image', 'url(' + url + ')');
                                $("#main-picture-indicator").hide();
                            }

                            function addGalleryPicture(url, id) {
                                $("#gallery").append('<div class="col-sm-3 gallery-item"><span class="glyphicon glyphicon-remove gallery-remove"></span><div class="alpha"></div><img class="img-rounded" src="' + url + '" data-picture-id="' + id + '"></div>');
                            }

                            function procesaFormularioInicial() {
                                // - Main Picture
                                var mainPictureInputName = "#id_{{ form.main_picture_id.name }}";
                                var $mainPictureInput = $(mainPictureInputName);
                                // La url está almacenada en el atributo initial-picture-url
                                var mainPictureUrl = $mainPictureInput.attr("initial-picture-url");
                                if (mainPictureUrl) {
                                    setMainPicture(mainPictureUrl);
                                }

                                // - Gallery
                                // Las urls se guardan en items de una lista oculta
                                $("#initial-pictures-urls").find("li").each(function (index, item) {
                                    var url = $(item).text();
                                    var id = $(item).attr('data-picture-id');
                                    galleryArray[url] = id;
                                    addGalleryPicture(url, id);
                                });
                            }


                            $().ready(function () {

                                var $form = $("#recipe-form");
                                $form.submit(function (e) {
                                    //e.preventDefault();

                                    // Genera el json de fotos
                                    var pictures = [];
                                    $(".gallery-item").each(function (index, element) {
                                        var picture_id = $(element).find("img").attr("data-picture-id");
                                        if (picture_id) {
                                            pictures.push(picture_id);
                                        }
                                    });
                                    if (pictures.length) {
                                        var picturesInput = $("<input>")
                                                .attr("type", "hidden")
                                                .attr("name", "{{ form.pictures_ids_json.name }}")
                                                .val(JSON.stringify(pictures));
                                        $form.append(picturesInput);
                                    }


                                    // Genera el json de ingredientes
                                    var ingredients = [];
                                    $(".ingredient-item").each(function (index, element) {
                                        if (!$(element).hasClass("repeatable-template")) {
                                            var ingredient = $(element).find(".ingredient-input").val();
                                            if (ingredient) {
                                                ingredients.push(ingredient);
                                            }
                                        }
                                    });
                                    if (ingredients.length) {
                                        var ingredientsInput = $("<input>")
                                                .attr("type", "hidden")
                                                .attr("name", "{{ form.ingredients_json.name }}")
                                                .val(JSON.stringify(ingredients));
                                        $form.append(ingredientsInput);
                                    }

                                    // Genera el json de pasos
                                    var steps = [];
                                    $(".step").each(function (index, element) {
                                        if (!$(element).hasClass("repeatable-template")) {
                                            var step = {};
                                            var stepText = $(element).find(".step-input").val();
                                            if (stepText) {
                                                step['text'] = stepText;
                                                var pictureId = $(element).find("img").attr("data-picture-id");
                                                if (pictureId) {
                                                    step['picture'] = pictureId;
                                                }
                                                steps.push(step);
                                            }
                                        }
                                    });
                                    if (steps.length) {
                                        var stepsInput = $("<input>")
                                                .attr("type", "hidden")
                                                .attr("name", "{{ form.steps_json.name }}")
                                                .val(JSON.stringify(steps));
                                        $form.append(stepsInput);
                                    }
                                });

                                procesaFormularioInicial();

                                // Drag&Drop for main picture
                                activateDragAndDrop($("#main-picture"), "{% url 'upload' %}", function (returndata) {
                                    var response = $.parseJSON(returndata);
                                    setMainPicture(response.url);
                                    // Guardar la info en un campo oculto
                                    var input_id = "#id_{{ form.main_picture_id.name }}";
                                    $(input_id).val(response.id);
                                });

                                // Drag&Drop for gallery
                                var gallery = $("#gallery");
                                activateDragAndDrop(gallery, "{% url 'upload' %}", function (returndata) {
                                    var response = $.parseJSON(returndata);
                                    addGalleryPicture(response.url, response.id)

                                    // Guardar la info en un campo oculto
                                    var input_id = "#id_{{ form.pictures_ids_list.name }}";
                                    var current_val = $(input_id).val();
                                    $(input_id).val(current_val + ";" + response.id);

                                    // Y en una variable global
                                    galleryArray[response.url] = response.id;
                                });

                                $(".step-list").on("click", ".step-picture", function (event) {
                                    var stepPicture = $(this);
                                    var stepIndex = stepPicture.attr("data-step-index");

                                    var $modal = $("#modal-picture");
                                    $modal.modal("show");
                                    var $gallery = $modal.find("#gallery-modal");
                                    $gallery.empty();

                                    var urls = [];
                                    $("#gallery").find(".gallery-item").each(function (index, Element) {
                                        urls.push($(Element).find("img").attr("src"))
                                    });

                                    for (var i = 0; i < urls.length; i++) {
                                        $gallery.append('<div class="col-sm-3 gallery-item"><img class="img-rounded" src="' + urls[i] + '"></div>');
                                    }

                                    $gallery.find(".gallery-item").click(function (e) {
                                        var url = $(this).find("img").attr("src");
                                        var id = galleryArray[url];

                                        var $control = stepPicture.find(".step-picture-add");
                                        var $pic = stepPicture.find("img");

                                        $pic.attr("src", url);
                                        $pic.attr("data-picture-id", id);
                                        $pic.parent().show();

                                        $control.hide();

                                        $modal.modal("hide");
                                    });
                                });

                                $("#main-picture").click(function (event) {
                                    $("#image").click();
                                    $("#image").change(function (event){
                                        var files = $("#image")[0].files;

                                        handleFileUpload(files, $("#main-picture"), "{% url 'upload' %}", function (returndata) {
                                            var response = $.parseJSON(returndata);
                                            setMainPicture(response.url);
                                            // Guardar la info en un campo oculto
                                            var input_id = "#id_{{ form.main_picture_id.name }}";
                                            $(input_id).val(response.id);
                                        });
                                    });
                                });

                                $("#gallery").click(function (event) {
                                    $("#image").click();
                                    $("#image").change(function (event){
                                        var files = $("#image")[0].files;
                                        $(files).each(function(index){
                                            handleFileUpload($(files)[index], $("#gallery"), "{% url 'upload' %}", function (returndata) {
                                                var response = $.parseJSON(returndata);
                                                addGalleryPicture(response.url, response.id)

                                                // Guardar la info en un campo oculto
                                                var input_id = "#id_{{ form.pictures_ids_list.name }}";
                                                var current_val = $(input_id).val();
                                                $(input_id).val(current_val + ";" + response.id);

                                                // Y en una variable global
                                                galleryArray[response.url] = response.id;
                                            });
                                        });
                                    });
                                });

                                $("#gallery").on('click', '.gallery-remove', function (event) {
                                    event.stopPropagation();
                                    var galleryItem = $(this).parent();
                                    var url = $(galleryItem).find("img").attr("src");
                                    $(".step").each(function (index, element) {
                                        if (!$(element).hasClass("repeatable-template")) {
                                            var pictureId = $(element).find("img").attr("data-picture-id");
                                            if (pictureId==galleryArray[url]) {
                                                $(element).removeAttr("src");
                                                $(element).removeAttr("data-picture-id");
                                                $(element).find("img").parent().hide();
                                                $(element).find("a").show();
                                            }
                                        }
                                    });
                                    $("#gallery").find("img").each(function (index, element) {
                                        var pictureId = $(element).attr("data-picture-id");
                                        if (pictureId==galleryArray[url]) {
                                            $(element).removeAttr("src");
                                            $(element).parent().remove();
                                        }
                                    });
                                    delete galleryArray[url];
                                });

                                $(".step-list").on('click', ".gallery-remove", function (event) {
                                    event.stopPropagation();
                                    var galleryItem = $(this).parent();
                                    var url = $(galleryItem).find("img").attr("src");
                                    var img = $(galleryItem).find("img")
                                    var step = $(galleryItem).parent();
                                    $(img).removeAttr("src");
                                    $(img).removeAttr("data-picture-id");
                                    $(galleryItem).hide();
                                    $(step).find("a").show();
                                    delete galleryArray[url];
                                    return false;
                                });
                            });
                        </script>

                        <div class="panel panel-default">
                        <div class="panel-body">
                        <form role="form well well-lg" id="recipe-form" class="form-horizontal" method="post" enctype="multipart/form-data">

                        <h3 class="col-lg-offset-1">Información b&aacute;sica</h3>
                        <fieldset class="col-sm-10 col-sm-offset-1" style="padding: 20px 100px">

                            <!-- Title -->
                            <div class="form-group">
                                <div class="col-sm-12">
                                    Da nombre a t&uacute; receta
                                    <input type="text" class="form-control input-xlg" placeholder="Nombre de la receta"
                                           name="title" id="id_title"
                                           value="">
                                </div>
                            </div>

                            <!-- Main Image -->
                            <input type="hidden" id="id_{{ form.main_picture_id.name }}" name="{{ form.main_picture_id.name }}"
                                   initial-picture-url="{% picture_from_id form.main_picture_id.value %}"
                                   value="{{ form.main_picture_id.value |default:"" }}">

                            <div class="form-group">
                                <div class="col-sm-12">
                                    <div class="main-picture drop-target" id="main-picture">
                                        <div id="main-picture-indicator">
                                            <p>Añade una imagen</p>
                                            <span class="glyphicon glyphicon-camera"></span>

                                            <p>Arrastra aqu&iacute</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Gallery -->

                            <input type="hidden" id="id_{{ form.pictures_ids_list.name }}" name="{{ form.pictures_ids_list.name }}"
                                   value="{{ form.pictures_ids_list.value |default:"" }}">
                            <div class="form-group">
                                <div class="col-sm-12">
                                    <div class="row gallery drop-target" id="gallery">
                                        <!-- Gallery item -->
                                        <div class="col-sm-3 gallery-item">
                                            <img class="img-rounded"
                                                 src="statics/image/piruleta.jpg">
                                        </div>
                                        <div id="gallery-indicator">
                                            <p>Añade m&aacutes im&aacute;genes</p>
                                            <span class="glyphicon glyphicon-plus"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Description -->
                            <div class="form-group">
                                <div class="col-sm-12">
                                    <!-- <label for="id_{{ form.description.name }}"
                                   class="col-sm-2 ">{{ form.description.label }}</label> -->
                                    Escribe una breve descripci&oacute;n sobre la receta
                                    <textarea class="form-control input-lg"
                                              placeholder="Descripci&oacute;n"
                                              rows="4"
                                              name="description" id="description"
                                            ></textarea>
                                </div>

                            </div>
                        </fieldset>

                        <span class="clearfix"></span>

                        <h3 class="col-lg-offset-1">C&oacute;mo se hace</h3>
                        <fieldset class="col-sm-10 col-sm-offset-1" style="padding: 20px 100px">
                            <!-- Ingredients -->
                            <h4>Lista de ingredientes</h4>

                            <input type="hidden" id="id_{{ form.ingredients_list.name }}" name="{{ form.ingredients_list.name }}">

                            <div class="repeat">
                                <div class="form-group repeatable-wrapper">
                                    <div class="repeatable-container">
                                        <!-- ingredient-item -->
                                        <div class="form-group ingredient-item repeatable-row repeatable-template">
                                            <div class="col-sm-8 col-sm-offset-2">
                                                <div class="input-group">
                                                <span class="input-group-addon repeatable-move"><span
                                                        class="glyphicon glyphicon-sort"></span> </span>
                                                    <input type="text" class="form-control ingredient-input"
                                                           name="ingredient_{row-count-placeholder}"
                                                           id="id_ingredient_{row-count-placeholder}"
                                                           autofocus="autofocus"
                                                            >
                                                <span class="input-group-btn ingredient-remove">
                                                    <button class="btn btn-default repeatable-remove" type="button"><span
                                                            class="glyphicon glyphicon-remove"></span></button>
                                                </span>
                                                </div>
                                            </div>
                                        </div>



                                    </div>


                                </div>
                            </div>

                            <h4>Paso a paso</h4>

                            <div class="repeat">
                                <div class="form-group repeatable-wrapper step-list">
                                    <div class="repeatable-container step-container">
                                        <!-- Step item -->
                                        <div class="repeatable-row repeatable-template step-item">
                                            <div class="form-group step">
                                                <div class="col-sm-1">
                                                    <span class="step-num">{row-number-placeholder}</span>
                                                </div>
                                                <div class="col-sm-9">
                                                    Describe este paso
                                                    <textarea class="form-control input-lg step-input"
                                                              placeholder="{{ step_description }}"
                                                              rows="4"
                                                              name="step_{row-count-placeholder}" id="id_step_{row-count-placeholder}"
                                                              autofocus="autofocus"
                                                            ></textarea>
                                                    <span class="glyphicon glyphicon-remove recipe-step-remove repeatable-remove"></span>
                                                </div>
                                                <div class="col-sm-2 step-picture" data-step-index="{row-count-placeholder}">
                                                    <a class="btn btn-default step-picture-add"><span
                                                            class="glyphicon glyphicon-camera"></span></a>
                                                    <div class="gallery-item" style="display: none"><span class="glyphicon glyphicon-remove gallery-remove"></span><img class="img-rounded" src=""></div>
                                                </div>
                                            </div>
                                            <hr>
                                        </div>
                                        <!-- /Step item -->

                                        {% for step in form.get_steps_list %}
                                            <div class="repeatable-row">
                                                <div class="form-group step">
                                                    <div class="col-sm-1">
                                                        <span class="step-num">{{ forloop.counter }}</span>
                                                    </div>
                                                    <div class="col-sm-9">
                                                        {% trans "Describe this step..." as the_description %}
                                                        <textarea class="form-control input-lg step-input"
                                                                  placeholder="{{ the_description }}"
                                                                  rows="4"
                                                                  name="step_{{ forloop.counter0 }}" id="id_step_{{ forloop.counter0 }}"
                                                                >{{ step.text }}</textarea>
                                                        <span class="glyphicon glyphicon-remove recipe-step-remove repeatable-remove"></span>
                                                    </div>
                                                    <div class="col-sm-2 step-picture" data-step-index="{{ forloop.counter0 }}">
                                                        <input type="text" hidden name="step-picture-id_{{ forloop.counter0 }}"
                                                               value="{% step_picture form.data forloop.counter0 %}">
                                                        {% if step.picture %}
                                                            <a class="btn btn-default step-picture-add" style="display: none"><span
                                                                    class="glyphicon glyphicon-camera"></span></a>
                                                            <div class="gallery-item"><span class="glyphicon glyphicon-remove gallery-remove"></span><img class="img-rounded" data-picture-id="{{ step.picture }}"
                                                                 src="{% picture_from_id step.picture %}"></div>
                                                        {% else %}
                                                            <a class="btn btn-default step-picture-add"><span
                                                                    class="glyphicon glyphicon-camera"></span></a>
                                                            <div class="gallery-item" style="display: none"><span class="glyphicon glyphicon-remove gallery-remove"></span><img class="img-rounded" src="" style="display: none"></div>
                                                        {% endif %}
                                                    </div>
                                                </div>
                                                <hr>
                                            </div>
                                        {% endfor %}
                                    </div>
                                    <div class="form-group step">
                                        <div class="col-sm-1">
                                            <span>+</span>
                                        </div>
                                        <div class="col-sm-9">
                                            {% trans "Next step?" as the_new_desc %}
                                            <textarea class="form-control input-lg repeatable-add"
                                                      placeholder="{{ the_new_desc }}"
                                                      rows="4"
                                                      name="step" id="id_step"
                                                    ></textarea>
                                        </div>
                                    </div>

                                </div>
                            </div>

                            <div class="modal fade" id="modal-picture" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
                                 aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                            <h4 class="modal-title" id="myModalLabel">{% trans "Pick a picture" %}</h4>
                                        </div>
                                        <div class="modal-body">
                                            <div class="col-sm-12">
                                                <div class="row gallery" id="gallery-modal">
                                                    <!-- Gallery item -->
                                                    {% comment %}<div class="col-sm-3 gallery-item">
                                                        <img class="img-rounded"
                                                             src="http://www.cocinillas.es/wp-content/uploads/2011/05/DSC08380-1600x1200.jpg">
                                                    </div>{% endcomment %}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-default" data-dismiss="modal">{% trans "Cancel" %}</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <h5>{% trans "Additional notes" %}</h5>

                            <div class="form-group">
                                <div class="col-sm-12">
                                    {% trans "Anything else you want to point out about your recipe?" as place_holder %}
                                    <textarea class="form-control input-lg"
                                              placeholder="{{ place_holder }}"
                                              rows="3"
                                              name="{{ form.notes.name }}" id="id_{{ form.notes.name }}"
                                            >{{ form.notes.value | default_if_none:'' }}</textarea>
                                </div>
                            </div>
                        </fieldset>

                        <span class="clearfix"></span>

                        <h3 class="col-lg-offset-1">{% trans "Extra information" %}</h3>
                        <fieldset class="col-sm-10 col-sm-offset-1" style="padding: 20px 50px">

                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label" for="id_{{ form.prep_time.name }}">{% trans "Preparation time" %}</label>

                                        <div class="col-sm-5">
                                            <div class="input-group">
                                                {% trans "minutes" as pl_minutes %}
                                                <input type="number" class="form-control" placeholder="{{pl_minutes}}"
                                                       name="{{ form.prep_time.name }}" id="id_{{ form.prep_time.name }}"
                                                       value="{{ form.prep_time.value | default_if_none:'' }}">
                                                <span class="input-group-addon"><span
                                                        class="glyphicon glyphicon-time"></span> </span>
                                            </div>
                                            {% if form.prep_time.errors %}
                                                <div class="alert alert-danger">
                                                    {% for error in form.prep_time.errors %}
                                                        {{ error|escape }}
                                                    {% endfor %}
                                                </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label" for="id_{{ form.cook_time.name }}">{% trans "Cooking time" %}</label>

                                        <div class="col-sm-5">
                                            <div class="input-group">
                                                {%  trans "minutes" as pl_min %}
                                                <input type="number" class="form-control" placeholder="{{ pl_min }}"
                                                       name="{{ form.cook_time.name }}" id="id_{{ form.cook_time.name }}"
                                                       value="{{ form.cook_time.value | default_if_none:'' }}">
                                                <span class="input-group-addon"><span
                                                        class="glyphicon glyphicon-time"></span> </span>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>


                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label" for="id_{{ form.serves.name }}">{% trans "Serves" %}</label>

                                        <div class="col-sm-8">
                                            {% trans "Two persons or Five units" as serves_number %}
                                            <input type="text" class="form-control" placeholder="{{ serves_number }}"
                                                   name="{{ form.serves.name }}" id="id_{{ form.serves.name }}"
                                                   value="{{ form.serves.value | default_if_none:'' }}">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label" for="id_{{ form.difficult.name }}">{% trans "Difficulty" %}</label>

                                        <div class="col-sm-6">
                                            <select class="form-control" name="{{ form.difficult.name }}" id="id_{{ form.difficult.name }}">
                                                {% for choice in form.difficult.field.choices %}
                                                    <option value="{{ choice.0 }}"
                                                            {% ifequal form.difficult.value choice.0 %}
                                                            selected
                                                            {% endifequal %}
                                                            >{{ choice.1 }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label" for="id_{{ form.temporality.name }}">{% trans "Occasions" %}</label>

                                        <div class="col-sm-8">
                                            <select class="form-control show-tick" data-live-search="true" multiple title="{% trans "None selected" %}"
                                                    name="{{ form.temporality.name }}" id="id_{{ form.temporality.name }}">
                                                {% for choice in form.temporality.field.choices %}
                                                    <option value="{{ choice.0 }}"
                                                            {% for opt in form.temporality.value %}
                                                                {% ifequal opt choice.0 %}
                                                            selected
                                                                {% endifequal %}
                                                            {% endfor %}
                                                            >{{ choice.1 }}
                                                    </option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label" for="id_{{ form.food_type.name }}">{% trans "Food type" %}</label>

                                        <div class="col-sm-6">
                                            <select class="form-control show-tick" name="{{ form.food_type.name }}"
                                                    id="id_{{ form.food_type.name }}">
                                                {% for choice in form.food_type.field.choices %}
                                                    <option value="{{ choice.0 }}"
                                                            {% ifequal form.food_type.value choice.0 %}
                                                            selected
                                                            {% endifequal %}
                                                            >{{ choice.1 }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label" for="id_{{ form.special_conditions.name }}">{% trans "Special conditions" %}</label>

                                        <div class="col-sm-8">
                                            <select class="form-control show-tick" data-live-search="true" multiple title="{% trans "None selected" %}"
                                                    name="{{ form.special_conditions.name }}" id="id_{{ form.special_conditions.name }}">
                                                {% for choice in form.special_conditions.field.choices %}
                                                    <option value="{{ choice.0 }}"
                                                            {% for opt in form.special_conditions.value %}
                                                                {% ifequal opt choice.0 %}
                                                            selected
                                                                {% endifequal %}
                                                            {% endfor %}
                                                            >{{ choice.1 }}
                                                    </option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label" for="id_{{ form.languages.name }}">{% trans "Language" %}</label>

                                        <div class="col-sm-6">
                                            <select class="form-control show-tick" name="{{ form.language.name }}"
                                                    id="id_{{ form.language.name }}">
                                                {% for choice in form.language.field.choices %}
                                                    <option value="{{ choice.0 }}"
                                                            {% ifequal form.language.value choice.0 %}
                                                            selected
                                                            {% endifequal %}
                                                            >{{ choice.1 }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label" for="id_{{ form.tags.name }}">{% trans "Free tags" %}</label>

                                        <div class="col-sm-8">
                                            {% trans "Comma separated tags" as pl_comma %}
                                            <input type="text" class="form-control" placeholder="{{ pl_comma }}"
                                                   name="{{ form.tags.name }}" id="id_{{ form.tags.name }}"
                                                   value="{{ form.tags.value | default_if_none:'' }}">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label" for="id_{{ form.nationality.name }}">{% trans "Nationality" %}</label>

                                        <div class="col-sm-6">
                                            <input type="text" class="form-control" placeholder="{{ pl_comma }}"
                                                   name="{{ form.nationality.name }}" id="id_{{ form.nationality.name }}"
                                                   value="{{ form.nationality.value | default_if_none:'' }}">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </fieldset>

                        <span class="clearfix"></span>

                        <h3 class="col-lg-offset-1">Sabores</h3>
                        <fieldset class="col-sm-10 col-sm-offset-1" style="padding: 20px 50px">
                            <!-- Savours-->
                            <div class="col-sm-6">
                                <label for="form.salty" class="slider-label">Salado</label>

                                <div class="control-group">
                                    <input type="number" class="form-control slider"
                                           name="form.salty" id="form.salty"
                                           data-slider-min="0"
                                           data-slider-max="99"
                                           data-slider-value="0"
                                           data-slider-tooltip="hide"
                                           data-slider-id="salty"
                                           value="0"
                                            >
                                </div>

                                <div class="control-group">
                                    <label for="form.sour" class="slider-label">Agrio</label>
                                    <input type="number" class="form-control slider"
                                           name="form.sour" id="form.sour"
                                           data-slider-min="0"
                                           data-slider-max="99"
                                           data-slider-value="5"
                                           data-slider-tooltip="hide"
                                           data-slider-id="sour"
                                           value="5"
                                            >
                                </div>

                                <div class="control-group">
                                    <label for="form.bitter" class="slider-label">Amargo</label>
                                    <input type="number" class="form-control slider"
                                           name="form.bitter" id="form.bitter"
                                           data-slider-min="0"
                                           data-slider-max="99"
                                           data-slider-value="5"
                                           data-slider-tooltip="hide"
                                           data-slider-id="bitter"
                                           value="5"
                                            >
                                </div>

                                <div class="control-group">
                                    <label for="form.sweet" class="slider-label">Dulce</label>
                                    <input type="number" class="form-control slider"
                                           name="form.sweet" id="form.sweet"
                                           data-slider-min="0"
                                           data-slider-max="99"
                                           data-slider-value="90"
                                           data-slider-tooltip="hide"
                                           data-slider-id="sweet"
                                           value="90"
                                            >
                                </div>

                                <div class="control-group">
                                    <label for="form.spicy" class="slider-label">Picante</label>
                                    <input type="number" class="form-control slider"
                                           name="form.spicy" id="form.spicy"
                                           data-slider-min="0"
                                           data-slider-max="99"
                                           data-slider-value="0"
                                           data-slider-tooltip="hide"
                                           data-slider-id="spicy"
                                           value="0"
                                            >
                                </div>

                                <div id="steps-div">
                                    <textarea id="steps" style="display:none" name="steps"></textarea>
                                </div>
                            </div>

                            <div class="col-sm-6">
                                <p class="savours-help">Los valores de sabor definen t&uacute; receta. De esta forma podemos recomendarla. Los sabores son una medida relativa</p>
                            </div>
                        </fieldset>

                        <!-- Submit Button -->
                        <fieldset class="col-sm-10 col-sm-offset-1" style="padding: 20px 50px">
                            <div class="form-group">
                                <label for="inputDisplayName" class="col-sm-1 control-label"></label>

                                <div class="col-sm-3">
                                    <input type="submit" class="btn btn-success" value="Publicar"/>
                                </div>
                            </div>
                        </fieldset>
                        </form>

                        <!-- Ajax uploads -->
                        <form action="" method="post" enctype="multipart/form-data" id="upload-form"
                              style="display: none">
                            <input type="file" multiple name="image" id="image" />

                        </form>
                        </div>
                        </div>

                    </div>
                    <!-- Modal -->
                    <div class="modal fade" id="modalFeedback" tabindex="-1" role="dialog" aria-labelledby="myModalFeedback"
                         aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                    <h4 class="modal-title" id="myModalFeedback">Feedback</h4>
                                </div>
                                <div class="modal-body">
                                    <p></p>
                                    <p></p>
                                    <p></p>
                                </div>
                                <div class="modal-footer">
                                    <a class="plus btn btn-default"
                                       href="mailto:eathub.contact@gmail.com?subject=Feedback sobre eathub!"></a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- /.container -->
                </main>
                <footer class="hidden-xs hidden-sm">
                    <div class="footer">
                        <div class="col-md-4 footer-logo-container">
                            <span class="footer-logo-helper"></span>
                            <img class="footer-logo" src="/statics/image/logo_footer.png" class="img-circle">
                        </div>
                        <div class="col-md-8 footer-content">
                            <div class="row">
                                <div class="col-md-2 text-center"><a href="" class="footer-link">T&eacute;minos y condiciones</a></div>
                                <div class="col-md-2 text-center"><a href="" class="footer-link">Sobre Eathub</a></div>
                                <div class="col-md-2 text-center"><a href="" class="footer-link">Equipo</a></div>
                                <div class="col-md-2 text-center"><a href="" class="footer-link">Contacto</a></div>
                            </div>
                        </div>
                    </div>
                    <!-- Bootstrap core JavaScript
                    ================================================== -->
                    <!-- Placed at the end of the document so the pages load faster -->
                    <script src="/statics/js/jquery.min.js"></script>
                    <script src="/statics/js/bootstrap.min.js"></script>
                    <script src="/statics/js/lightbox.min.js"></script>
                    <script>
                        $().ready(function () {
                            //XXX Cuidado, valores puestos a mano. Se podría animar con una clase usando jQueryUI
                                        $(".footer-logo").hover(
                                                function () {
                                                    $(".footer-logo").animate({"margin-bottom": "-35px"}, 150)
                                                },
                                                function () {
                                                    $(".footer-logo").animate({"margin-bottom": "-70px"}, 150)
                                                }
                                        );
                        });
                        var hideSuggest = function(event){
                            $(".suggest").css("display","none").fadeOut(2000);
                        }
                        $("#srchterm").focus(function(){
                           $(".suggest").css("display","block").fadeIn(2000);
                        });
                        $(".suggest").find("a").mouseenter(function(){
                           $("#srchterm").off("blur");
                        }).mouseleave(function(){
                           $("#srchterm").blur(hideSuggest);
                        });
                        $("#srchterm").blur(hideSuggest);
                        $("#srchterm").bind("input",function(){
                           var urlR = '/search/recipe/?srchterm=' +$(this).val();
                           $(".suggest").find(".category")[0].textContent=$(this).val();
                           $(".suggest").find("a")[0].href=urlR;
                           $(".suggest").find(".category")[1].textContent=$(this).val();
                           $(".suggest").find("a")[1].href='/search/person/' +$(this).val();
                        });
                    </script>
                </footer>
        </div>
    </body>
</html>
